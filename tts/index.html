<!DOCTYPE html>
<html>
<head>
    <title>Text-to-Speech App</title>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <main>
        <h1>Text-to-Speech App</h1>
        <form id="speechForm">
            <div>
                <label for="voices">Select a voice:</label>
            </div>

            <select id="voices"></select>

            <div>
                <textarea id="text">Type your text here.

The app is front-end but might send data over the Internet depending on your OS and browser.

The available voices also vary depending on your OS and browser.

To find out if you can use the app privately, you can try to disconnect momentarily from the Internet and see if the app is still working.
                
                </textarea>
            </div>

            <div>
                <button type="submit">Speak</button>
            </div>

        </form>
    </main>

    <script>
        let voicesDropdown = document.getElementById('voices');
        let textArea = document.getElementById('text');
        let speechForm = document.getElementById('speechForm');

        function populateVoices() {
            let voices = speechSynthesis.getVoices();

            voices.forEach(voice => {
                let option = document.createElement('option');
                option.textContent = `${voice.name} (${voice.lang})`;
                option.setAttribute('data-lang', voice.lang);
                option.setAttribute('data-name', voice.name);
                voicesDropdown.appendChild(option);
            });
        }

        function speakText(event) {
            event.preventDefault();
            let utterance = new SpeechSynthesisUtterance(textArea.value);
            let selectedOption = voicesDropdown.selectedOptions[0]?.getAttribute('data-name');
            let voices = speechSynthesis.getVoices();
            for(let i = 0; i < voices.length ; i++){
                if(voices[i].name === selectedOption){
                    utterance.voice = voices[i];
                }
            }
            speechSynthesis.speak(utterance);
        }

        speechSynthesis.onvoiceschanged = populateVoices;
        speechForm.onsubmit = speakText;
    </script>
</body>
</html>
